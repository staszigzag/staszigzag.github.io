(function(e){function t(t){for(var r,s,a=t[0],l=t[1],c=t[2],d=0,h=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&h.push(o[s][0]),o[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var l=n[a];0!==o[l]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var u=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("calendar-grid")],1)},i=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"calendar"},[n("ul",{staticClass:"calendar__days"},[n("li",{staticClass:"calendar__day calendar__day--first"}),e._l(e.days,(function(t,r){return n("li",{key:r,staticClass:"calendar__day"},[n("span",{staticClass:"calendar__day-week"},[e._v(e._s(t))]),n("br"),n("span",{staticClass:"calendar__day-num"},[e._v(e._s(e.numberDays[r]))])])}))],2),n("div",{ref:"viewGrid",staticClass:"calendar__view-grid"},[n("ul",{staticClass:"calendar__col calendar__col--first"},e._l(24,(function(t){return n("li",{key:t,staticClass:"calendar__cell calendar__cell--first"},[1!==t?n("span",{staticClass:"calendar__hour"},[e._v(e._s(--t)+":00")]):e._e()])})),0),n("div",{ref:"wrapGrid",staticClass:"calendar__wrap-grid"},[e._l(7,(function(t){return n("ul",{key:t,staticClass:"calendar__col"},e._l(24,(function(e){return n("li",{key:e,staticClass:"calendar__cell",attrs:{"data-row":t,"data-cell":--e}})})),0)})),e._l(e.listNotes,(function(e){return n("calendar-grid-note",{key:e.id+"note",attrs:{note:e}})})),e.dragNote?n("calendar-grid-controller-note",{attrs:{wrap:e.$refs.wrapGrid,view:e.$refs.viewGrid}}):e._e()],2)])])},a=[],l=n("5530"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"note",class:{"note--drag":!!e.dragNote&&e.note.id===e.dragNote.id,"note--small":e.note.isTimeAm||e.note.isTimePm,"note--time-am":e.note.isTimeAm},style:{left:e.sizeCell.w*(e.note.dayWeek-1)+"px",top:e.sizeCell.h*e.note.hour+1+e.offsetTimePm+"px"},attrs:{"data-row":e.note.dayWeek,"data-cell":e.note.hour}},[e._v(" "+e._s(e.note.title)+" "),n("br"),e._v(" "+e._s(e.note.isTimeAm||e.note.isTimePm?"":e.note.hour+":00 - "+(e.note.hour+1)+":00")+" ")])},u=[],d=n("2f62"),h={name:"CalendarGridNote",props:{note:{type:Object,required:!0}},data:function(){return{}},computed:Object(l["a"])(Object(l["a"])({},Object(d["b"])(["sizeCell","dragNote"])),{},{offsetTimePm:function(){return this.note.isTimePm?this.sizeCell.h/2:0}}),mounted:function(){var e=this;this.$el.onmousedown=function(){var t=function t(){e.$store.commit("SET_DRAG_NOTE",e.note),document.removeEventListener("mousemove",t)};document.addEventListener("mousemove",t)}}},f=h,m=(n("c0ba"),n("2877")),p=Object(m["a"])(f,c,u,!1,null,"dc1fc710",null),v=p.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"note-controller"},[e._v(" day week "+e._s(e.d)),n("br"),e._v(" "+e._s(e.h)+":00 - "+e._s(Number(e.h)+1)+":00 ")])},g=[],w={name:"CalendarGridControllerNote",props:{wrap:{required:!0},view:{required:!0}},data:function(){return{scrollTopWrap:0,viewLeftDistance:0,viewTopDistance:0,d:0,h:0}},created:function(){this.handlerScrollViewGrid(),this.view.onscroll=this.handlerScrollViewGrid,this.viewLeftDistance=this.wrap.getBoundingClientRect().left,this.viewTopDistance=this.wrap.getBoundingClientRect().top+this.scrollTopWrap},mounted:function(){this.controlCordinatesControllera(event.pageX-this.viewLeftDistance,event.pageY-this.viewTopDistance),document.addEventListener("mousemove",this.handlerMoveMouse),document.addEventListener("mouseup",this.handlerUpKeyMouse)},methods:{handlerScrollViewGrid:function(){this.scrollTopWrap=this.view.scrollTop},controlCordinatesControllera:function(e,t){t<this.$el.offsetHeight/2?this.$el.style.top=this.scrollTopWrap+"px":t>this.view.offsetHeight-this.$el.offsetHeight/2?this.$el.style.top=Math.floor(this.view.offsetHeight-this.$el.offsetHeight+this.scrollTopWrap)+"px":this.$el.style.top=t-this.$el.offsetHeight/2+this.scrollTopWrap+"px",e<this.$el.offsetWidth/2?this.$el.style.left="0px":e>this.wrap.offsetWidth-this.$el.offsetWidth/2?this.$el.style.left=Math.floor(this.wrap.offsetWidth-this.$el.offsetWidth)+"px":this.$el.style.left=e-this.$el.offsetWidth/2+"px"},getBelowElem:function(){this.$el.style.visibility="hidden";var e=document.elementFromPoint(event.clientX,event.clientY);return this.$el.style.visibility="visible",e},handlerMoveMouse:function(e){var t=this.getBelowElem();t&&t.dataset&&t.dataset.row&&(this.d=t.dataset.row),t&&t.dataset&&t.dataset.cell&&(this.h=t.dataset.cell),this.controlCordinatesControllera(e.pageX-this.viewLeftDistance,e.pageY-this.viewTopDistance)},handlerUpKeyMouse:function(e){console.log("handlerUpKeyMouse");var t=this.getBelowElem();t&&t.dataset&&t.dataset.row&&this.$store.commit("UPDATE_TIME_NOTE",{day:t.dataset.row,hour:t.dataset.cell}),this.$store.commit("SET_DRAG_NOTE",null),document.removeEventListener("mousemove",this.handlerMoveMouse),document.removeEventListener("mouseup",this.handlerUpKeyMouse)}},computed:Object(l["a"])({},Object(d["b"])(["sizeCell","dragNote"]))},y=w,b=(n("e3a2"),Object(m["a"])(y,_,g,!1,null,"6b07e886",null)),T=b.exports,E={name:"Calendar",components:{CalendarGridNote:v,CalendarGridControllerNote:T},data:function(){return{days:["ПН","ВТ","СР","ЧТ","ПТ","СБ","ВС"]}},mounted:function(){this.setSizeCell(),window.onresize=this.setSizeCell},methods:{setSizeCell:function(){var e=7,t=24;this.$store.commit("SET_SIZE_CELL",{w:this.$refs.wrapGrid.clientWidth/e,h:this.$refs.wrapGrid.clientHeight/t})}},computed:Object(l["a"])({},Object(d["b"])(["listNotes","numberDays","dragNote"]))},N=E,C=(n("7b2f"),Object(m["a"])(N,s,a,!1,null,"6de5574b",null)),D=C.exports,O={name:"App",components:{CalendarGrid:D}},$=O,S=(n("5c0b"),Object(m["a"])($,o,i,!1,null,null,null)),j=S.exports,W=(n("4de4"),n("4160"),n("a9e3"),n("159b"),n("96cf"),n("1da1")),k=(n("d81d"),n("d3b7"),n("d4ec")),M=n("bee2"),x=function(){function e(t){var n=t.id,r=t.title,o=void 0===r?"":r,i=t.startDate,s=t.endDate;Object(k["a"])(this,e),this.id=n,this.title=o,this.timestamp=1e3*i,this.end=new Date(1e3*s);var a=new Date(this.timestamp);this.dayWeek=a.getDay()||7,this.hour=a.getHours(),this.isTimeAm=!1,this.isTimePm=!1}return Object(M["a"])(e,[{key:"setTime",value:function(e,t){if(void 0===e)return console.error("not value hour");if(void 0===t)return console.error("not value day Week");if(t<0||t>7)return console.error("not valid day week");if(e<0||e>23)return console.error("not valid hour");var n=t-this.dayWeek,r=new Date(this.timestamp);r.setDate(r.getDate()+n),r.setHours(e),r.setMinutes(0),this.timestamp=r.getTime(),console.log("new time start",r),this.hour=e,this.dayWeek=t}}]),e}();function P(){var e="./assets/date.json";return fetch(e).then((function(e){return e.json()})).then((function(e){return e.forEach((function(e,t){return e.id=++t})),e.map((function(e){return new x(e)}))})).catch((function(e){return console.error(e.message)}))}function G(e){var t=new Date(e),n=t.getDay()||7;t.setDate(t.getDate()-(n-1));for(var r=[],o=0;o<7;o++)r[o]=t.getDate(),t.setDate(t.getDate()+1);return r}r["a"].use(d["a"]);var A=new d["a"].Store({state:{listNotes:[],dragNote:null,numberDays:[],sizeCell:{w:0,h:0}},mutations:{SET_NEW_NOTES:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.forEach((function(t){var n=e.listNotes.filter((function(e){return e.dayWeek===t.dayWeek&&e.hour===t.hour}));n.length||e.listNotes.push(t),n.length>1?console.warn("not places for note",t):1===n.length&&(n[0].isTimeAm=!0,t.isTimePm=!0,e.listNotes.push(t))}))},SET_NUMBER_DAYS:function(e,t){e.numberDays=t},SET_SIZE_CELL:function(e,t){var n=t.w,r=t.h;e.sizeCell={w:n,h:r}},SET_DRAG_NOTE:function(e,t){console.log("SET_DRAG_NOTE"),e.dragNote=t},UPDATE_TIME_NOTE:function(e,t){var n=t.day,r=t.hour;console.log("UPDATE_TIME_NOTE"),n=Number(n),r=Number(r);var o=e.listNotes.filter((function(t){return t.dayWeek===e.dragNote.dayWeek&&t.hour===e.dragNote.hour}));console.log("from",o.length);var i=e.listNotes.filter((function(e){return e.dayWeek===n&&e.hour===r}));console.log("to",i.length),i.length>1||(o.length>1&&o.forEach((function(e){e.isTimeAm=e.isTimePm=!1})),i.length?1===i.length&&i[0].id!==e.dragNote.id&&(e.dragNote.setTime(r,n),e.dragNote.isTimePm=!0,i[0].isTimeAm=!0):e.dragNote.setTime(r,n))}},actions:{getNotes:function(e){return Object(W["a"])(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,P();case 3:r=t.sent,console.log("notes from api",r),n("SET_NEW_NOTES",r),o=G(r[0].timestamp),n("SET_NUMBER_DAYS",o);case 8:case"end":return t.stop()}}),t)})))()}}});A.dispatch("getNotes"),r["a"].config.productionTip=!1,new r["a"]({store:A,render:function(e){return e(j)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),o=n.n(r);o.a},7310:function(e,t,n){},"79de":function(e,t,n){},"7b2f":function(e,t,n){"use strict";var r=n("79de"),o=n.n(r);o.a},"9c0c":function(e,t,n){},a5c1:function(e,t,n){},c0ba:function(e,t,n){"use strict";var r=n("7310"),o=n.n(r);o.a},e3a2:function(e,t,n){"use strict";var r=n("a5c1"),o=n.n(r);o.a}});
//# sourceMappingURL=app.fa2d0a87.js.map