(function(t){function e(e){for(var r,i,c=e[0],s=e[1],u=e[2],m=0,d=[];m<c.length;m++)i=c[m],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=s;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"1aa6":function(t,e,n){"use strict";var r=n("db2c"),a=n.n(r);a.a},2243:function(t,e,n){"use strict";var r=n("bc04"),a=n.n(r);a.a},"262d":function(t,e,n){"use strict";var r=n("4db4"),a=n.n(r);a.a},"4db4":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"getConfig",(function(){return Oe})),n.d(r,"getRooms",(function(){return ge})),n.d(r,"getHistory",(function(){return Re}));var a={};n.r(a),n.d(a,"getSocket",(function(){return Se}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("transition",{attrs:{appear:"",mode:"out-in",name:"opacity-fade"}},[t.loading?n("v-progress-linear",{attrs:{indeterminate:"",height:"12",color:"primary"}}):n("router-view")],1),n("nane-notifications"),n("nane-bottom-sheet")],1)},c=[],s=(n("b0c0"),n("96cf"),n("1da1")),u=n("5530"),l=n("2f62"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("transition-group",{attrs:{appear:"",mode:"out-in",name:"slide-fade"}},t._l(t.notifications,(function(e,r){return n("v-snackbar",{key:e.id,style:{top:t.widthSnackbar*r+"px"},attrs:{top:"",right:"",color:e.color,timeout:6e4,value:e},scopedSlots:t._u([{key:"action",fn:function(){return[n("v-btn",{attrs:{text:""},on:{click:function(n){return t.DELETE_NOTIFICATION(e)}}},[t._v(" Закрыть ")])]},proxy:!0}],null,!0)},[t._v(" "+t._s(e.text)+" ")])})),1)],1)},d=[],f={name:"NaneNotifications",data:function(){return{widthSnackbar:55}},computed:Object(u["a"])({},Object(l["d"])("notifications",["notifications"])),methods:Object(u["a"])({},Object(l["c"])("notifications",["DELETE_NOTIFICATION"]))},p=f,h=(n("262d"),n("2877")),v=n("6544"),O=n.n(v),b=n("8336"),g=n("2db4"),_=Object(h["a"])(p,m,d,!1,null,"bcf20030",null),R=_.exports;O()(_,{VBtn:b["a"],VSnackbar:g["a"]});var x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-bottom-sheet",{attrs:{value:!!t.userAction,persistent:"",inset:""}},[n("v-sheet",{staticClass:"text-center py-8"},[t.userAction?n("p",{staticClass:"text-h6"},[t._v(t._s(t.userAction.text))]):t._e(),n("v-btn",{staticClass:"mx-2",attrs:{width:"120px",color:"secondary"},on:{click:function(e){return t.handlerClickConfirm(!0)}}},[t._v("да")]),n("v-btn",{staticClass:"mx-2",attrs:{width:"120px",outlined:"",color:"error"},on:{click:function(e){return t.handlerClickConfirm(!1)}}},[t._v("нет")])],1)],1)},w=[],S={name:"NaneBottomSheet",data:function(){return{}},computed:Object(u["a"])({},Object(l["d"])("notifications",["userAction"])),methods:Object(u["a"])(Object(u["a"])({},Object(l["b"])("notifications",["resolveConfirmUserAction"])),{},{handlerClickConfirm:function(t){this.resolveConfirmUserAction(t)}})},C=S,E=n("288c"),k=n("8dd9"),j=Object(h["a"])(C,x,w,!1,null,"4a8f66be",null),y=j.exports;O()(j,{VBottomSheet:E["a"],VBtn:b["a"],VSheet:k["a"]});var T={name:"App",data:function(){return{loading:!0}},components:{NaneNotifications:R,NaneBottomSheet:y},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["b"])("rooms",["getRooms"])),Object(l["b"])("settings",["getSettings"])),Object(l["b"])("auth",["checkAuth","login"])),created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getSettings();case 3:return e.next=5,t.getRooms();case 5:return e.next=7,t.checkAuth();case 7:n=e.sent,n?t.login(n):(r="login",t.$route.name!==r&&t.$router.push({name:r}));case 9:return e.prev=9,t.loading=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,,9,12]])})))()}},A=T,N=(n("2243"),n("7496")),V=n("8e36"),L=Object(h["a"])(A,i,c,!1,null,"34be9017",null),M=L.exports;O()(L,{VApp:N["a"],VProgressLinear:V["a"]});var I=n("8c4f"),D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("main-header"),n("main-sidebar"),n("main-drawer"),n("main-chat"),n("main-modal-creat-room")],1)},G=[],P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nane-modal",{attrs:{value:t.isShowCreateRoom},on:{cancel:function(e){return t.TOGGLE_SHOW_CREATE_ROOM(!1)}}},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[n("v-toolbar-title",[t._v("Имя нового чата")]),n("v-spacer")],1),n("v-card-text",{staticClass:"pt-5"},[n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{counter:t.settings.maxRoomTitleLength,rules:[t.rules.required,t.rules.onlyString,t.rules.maxLength,t.rules.minLength],clearable:"",autocomplete:"off","prepend-icon":"mdi-comment-processing-outline",type:"text"},model:{value:t.nameRoom,callback:function(e){t.nameRoom=e},expression:"nameRoom"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{width:"120px",color:"secondary"},on:{click:t.handlerClickCreate}},[t._v("Создать")]),n("v-btn",{attrs:{width:"120px",outlined:"",color:"error"},on:{click:t.handlerClickClose}},[t._v("Закрыть")])],1)],1)},U=[],$=function(t){return!!t||"Это поле обязательно"},H=function(t){return"string"===typeof t||"Это поле только для строк"},W=function(t){return function(e){return!!e&&e.length>=t||"Минимальное количество символов "+t}},B=function(t){return function(e){return!!e&&e.length<=t||"Максимальное количество символов "+t}},F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{value:t.value,"max-width":800},on:{"click:outside":t.handlerClickCancel,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.handlerClickCancel(e)}}},[n("v-card",{staticClass:"elevation-12"},[t._t("default")],2)],1)},q=[],J={name:"NaneModal",data:function(){return{}},props:{value:{type:Boolean,default:!1}},methods:{handlerClickCancel:function(){this.$emit("cancel")}}},Y=J,K=n("b0af"),z=n("169a"),Q=Object(h["a"])(Y,F,q,!1,null,"5d8fd403",null),X=Q.exports;O()(Q,{VCard:K["a"],VDialog:z["a"]});var Z={name:"MainModalCreateRoom",data:function(){return{nameRoom:"",valid:!1,rules:{}}},components:{NaneModal:X},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("settings",["settings"])),Object(l["d"])("modals",["isShowCreateRoom"])),created:function(){this.initRules()},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["c"])("modals",["TOGGLE_SHOW_CREATE_ROOM"])),Object(l["b"])("rooms",["createRoom"])),{},{handlerClickCreate:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$refs.form.validate(),t.valid){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,t.createRoom(t.nameRoom);case 6:return e.prev=6,t.handlerClickClose(),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[3,,6,9]])})))()},handlerClickClose:function(){this.nameRoom="",this.TOGGLE_SHOW_CREATE_ROOM(!1)},initRules:function(){this.rules.required=$,this.rules.onlyString=H,this.rules.maxLength=B(this.settings.maxRoomTitleLength),this.rules.minLength=W(this.settings.minLength)}})},tt=Z,et=n("99d9"),nt=n("4bd4"),rt=n("2fa4"),at=n("8654"),ot=n("71d9"),it=n("2a7f"),ct=Object(h["a"])(tt,P,U,!1,null,"00e42c7e",null),st=ct.exports;O()(ct,{VBtn:b["a"],VCardActions:et["a"],VCardText:et["b"],VForm:nt["a"],VSpacer:rt["a"],VTextField:at["a"],VToolbar:ot["a"],VToolbarTitle:it["a"]});var ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app-bar",{attrs:{app:"",fixed:"","clipped-left":"",color:"primary",dark:""}},[n("v-toolbar-title",[t._v("Сега Мега Ай-нане чат !!")]),n("v-spacer"),n("v-icon",{staticClass:"mr-2"},[t._v("mdi-comment-account-outline")]),n("v-toolbar-title",{staticClass:"font-weight-bold text-h5 text-uppercase "},[t._v(" "+t._s(t.userName)+" ")]),n("v-spacer"),n("v-btn",{staticClass:"ma-2",attrs:{outlined:"",dark:""},on:{click:t.handlerClickLogout}},[t._v(" выход "),n("v-icon",{attrs:{right:""}},[t._v("mdi-exit-to-app")])],1)],1)},lt=[],mt={name:"MainHeader",data:function(){return{}},computed:Object(u["a"])({},Object(l["d"])("auth",["userName"])),methods:Object(u["a"])(Object(u["a"])(Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["b"])("auth",["logout"])),Object(l["b"])("socket",["disconnectSocket"])),Object(l["c"])("rooms",["RESET_ROOMS"])),Object(l["b"])("notifications",["confirmUserAction"])),{},{handlerClickLogout:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.confirmUserAction();case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,t.logout();case 8:return e.next=10,t.disconnectSocket();case 10:t.RESET_ROOMS();case 11:return e.prev=11,t.$router.push({name:"login"}),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[5,,11,14]])})))()}})},dt=mt,ft=n("40dc"),pt=n("132d"),ht=Object(h["a"])(dt,ut,lt,!1,null,"fa632524",null),vt=ht.exports;O()(ht,{VAppBar:ft["a"],VBtn:b["a"],VIcon:pt["a"],VSpacer:rt["a"],VToolbarTitle:it["a"]});var Ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-navigation-drawer",{attrs:{width:"400px",value:t.isShowDrawer,fixed:"",temporary:""},on:{input:function(e){return t.TOGGLE_SHOW_DRAWER(e)}},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("v-list-item",{staticClass:"text-center mt-2"},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"text-uppercase font-weight-medium"},[t._v("Список чатов")])],1)],1),n("v-divider")]},proxy:!0}])},[n("v-list",{attrs:{inlist:"",subheader:"","three-line":""}},[t._l(t.rooms,(function(e,r){return[n("v-list-item",{key:r,class:{"grey lighten-2":e.isActive},on:{click:function(n){return n.stopPropagation(),t.handlerClickRoom(e)}}},[n("v-list-item-content",{},[n("v-list-item-title",[t._v(" "+t._s(e.name)+" ")]),e.lastMessage?n("v-list-item-subtitle",{staticClass:"caption"},[t._v(" «"+t._s(e.lastMessage.text)+"» ")]):t._e()],1),n("v-list-item-icon",{staticClass:"pt-4"},[e.isActive?n("v-icon",{attrs:{color:"primary "}},[t._v("star")]):t._e()],1)],1),n("v-divider",{key:r+"x"})]}))],2)],1)},bt=[],gt={name:"MainDrawer",data:function(){return{}},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("modals",["isShowDrawer"])),Object(l["d"])("rooms",["rooms"])),methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["c"])("modals",["TOGGLE_SHOW_DRAWER"])),Object(l["b"])("rooms",["initActiveRoom"])),{},{handlerClickRoom:function(t){this.TOGGLE_SHOW_DRAWER(!1),t.isActive||this.initActiveRoom(t)}})},_t=gt,Rt=n("ce7e"),xt=n("8860"),wt=n("da13"),St=n("5d23"),Ct=n("34c3"),Et=n("f774"),kt=Object(h["a"])(_t,Ot,bt,!1,null,"64952d2a",null),jt=kt.exports;O()(kt,{VDivider:Rt["a"],VIcon:pt["a"],VList:xt["a"],VListItem:wt["a"],VListItemContent:St["a"],VListItemIcon:Ct["a"],VListItemSubtitle:St["b"],VListItemTitle:St["c"],VNavigationDrawer:Et["a"]});var yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-navigation-drawer",{attrs:{width:t.$vuetify.breakpoint.xs?150:270,clipped:"",permanent:"","disable-resize-watcher":"",app:""},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("v-list-item",{on:{click:function(e){return e.stopPropagation(),t.TOGGLE_SHOW_DRAWER(!0)}}},[n("v-list-item-content",[n("v-list-item-title",[t._v("Выбрать чат")])],1),n("v-list-item-action",[n("v-icon",[t._v("mdi-comment-multiple-outline")])],1)],1),n("v-list-item",{on:{click:function(e){return e.stopPropagation(),t.TOGGLE_SHOW_CREATE_ROOM(!0)}}},[n("v-list-item-content",[n("v-list-item-title",[t._v("Создать чат")])],1),n("v-list-item-action",[n("v-icon",[t._v("mdi-comment-plus-outline")])],1)],1),n("v-divider")]},proxy:!0}])},[n("v-list",{attrs:{dense:""}},t._l(t.activeRooms,(function(e,r){return n("v-list-item",{key:r,class:{secondary:e.isCurrent},on:{click:function(n){return n.stopPropagation(),t.handlerClickRoom(e)}}},[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(e.name))])],1),n("v-list-item-action",[e.isCurrent?n("v-icon",[t._v("mdi-comment-check-outline")]):t._e()],1)],1)})),1)],1)},Tt=[],At={name:"MainSidebar",data:function(){return{}},computed:Object(u["a"])({},Object(l["d"])("rooms",["activeRooms"])),methods:Object(u["a"])(Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["c"])("modals",["TOGGLE_SHOW_DRAWER"])),Object(l["c"])("modals",["TOGGLE_SHOW_CREATE_ROOM"])),Object(l["c"])("rooms",["SET_CURRENT_ROOM"])),{},{handlerClickRoom:function(t){this.SET_CURRENT_ROOM(t)}})},Nt=At,Vt=n("1800"),Lt=Object(h["a"])(Nt,yt,Tt,!1,null,"5ac214ce",null),Mt=Lt.exports;O()(Lt,{VDivider:Rt["a"],VIcon:pt["a"],VList:xt["a"],VListItem:wt["a"],VListItemAction:Vt["a"],VListItemContent:St["a"],VListItemTitle:St["c"],VNavigationDrawer:Et["a"]});var It=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-main",[n("v-container",{staticClass:"fill-height pa-0",attrs:{fluid:""}},[t.currentRoom?n("div",{staticClass:"wrapper"},[n("div",{ref:"chat",staticClass:"chat"},[n("v-row",{attrs:{"no-gutters":""}},t._l(t.currentRoom.history,(function(t,e){return n("v-col",{key:e,attrs:{cols:"12"}},[n("message",{attrs:{msg:t}})],1)})),1)],1),n("div",{staticClass:"input-send"},[n("v-row",{staticClass:"pa-3 pt-5",attrs:{dense:"",align:"start"}},[n("v-col",{attrs:{cols:""}},[n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{clearable:"",autocomplete:"off",type:"text",counter:t.settings.maxMessageLength,rules:[t.rules.required,t.rules.onlyString,t.rules.maxLength],placeholder:"Ваше сообщение",outlined:""},model:{value:t.msgText,callback:function(e){t.msgText=e},expression:"msgText"}})],1)],1),n("v-col",{attrs:{cols:"auto"}},[n("v-btn",{attrs:{"x-large":"",color:"primary"},on:{click:function(e){return t.handleClickSend()}}},[n("v-icon",{attrs:{large:""}},[t._v("mdi-send")])],1)],1)],1)],1)]):n("p",{staticClass:"hint text-center body-1 grey--text text--lighten-1"},[t._v("Нет выбранного чата...")])])],1)},Dt=[],Gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticClass:"ma-2 ",class:{"align-self-end":t.isSudo},attrs:{width:"70%",color:t.isSudo?"grey lighten-1 ml-auto":"grey lighten-3",dark:t.isSudo}},[n("v-card-title",{staticClass:"body-2 pa-2"},[t.isSudo?t._e():n("v-icon",{staticClass:"mr-2"},[t._v("mdi-account")]),t._v(" "+t._s(t.msg.sender)+" ")],1),n("v-card-text",{staticClass:"body-2 pa-2"},[t._v(t._s(t.msg.text))])],1)},Pt=[],Ut={name:"Message",data:function(){return{}},props:{msg:{type:Object,required:!0}},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("auth",["userName"])),{},{isSudo:function(){return this.msg.sender===this.userName}})},$t=Ut,Ht=Object(h["a"])($t,Gt,Pt,!1,null,"6d2a2a18",null),Wt=Ht.exports;O()(Ht,{VCard:K["a"],VCardText:et["b"],VCardTitle:et["c"],VIcon:pt["a"]});var Bt={name:"MainChat",data:function(){return{msgText:"",valid:!1,rules:{}}},components:{Message:Wt},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("rooms",["currentRoom"])),Object(l["d"])("settings",["settings"])),watch:{"currentRoom.history":function(){this.scrollToBottom()}},created:function(){this.initRules()},methods:Object(u["a"])(Object(u["a"])({},Object(l["b"])("socket",["sendSocket"])),{},{scrollToBottom:function(){var t=this;this.$nextTick((function(){var e=t.$refs.chat;e.scrollTop=e.scrollHeight}))},handleClickSend:function(){this.$refs.form.validate(),this.valid&&(this.sendSocket({room:this.currentRoom.name,text:this.msgText}),this.$refs.form.reset())},initRules:function(){this.rules.required=$,this.rules.onlyString=H,this.rules.maxLength=B(this.settings.maxMessageLength)}})},Ft=Bt,qt=(n("1aa6"),n("62ad")),Jt=n("a523"),Yt=n("f6c4"),Kt=n("0fd9"),zt=Object(h["a"])(Ft,It,Dt,!1,null,"dfe01c52",null),Qt=zt.exports;O()(zt,{VBtn:b["a"],VCol:qt["a"],VContainer:Jt["a"],VForm:nt["a"],VIcon:pt["a"],VMain:Yt["a"],VRow:Kt["a"],VTextField:at["a"]});var Xt={name:"Main",data:function(){return{}},components:{MainModalCreatRoom:st,MainHeader:vt,MainDrawer:jt,MainSidebar:Mt,MainChat:Qt},computed:Object(u["a"])({},Object(l["d"])("auth",["userName"])),created:function(){this.init()},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["c"])("modals",["TOGGLE_SHOW_CREATE_ROOM"])),Object(l["b"])("socket",["connectSocket","sendSocket"])),{},{init:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.userName){e.next=5;break}return e.next=3,t.connectSocket(t.userName);case 3:e.next=6;break;case 5:t.$router.push({name:"login"});case 6:case"end":return e.stop()}}),e)})))()}})},Zt=Xt,te=Object(h["a"])(Zt,D,G,!1,null,"099ff172",null),ee=te.exports;O()(te,{VApp:N["a"]});var ne=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-main",[n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",md:"4",sm:"8"}},[n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[n("v-toolbar-title",[t._v("Ваше имя")]),n("v-spacer")],1),n("v-card-text",[n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{rules:[t.rules.required,t.rules.onlyString,t.rules.maxLength,t.rules.minLength],counter:t.settings.maxUserNameLength,clearable:"",autocomplete:"off","prepend-icon":"mdi-account",type:"text"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),n("v-card-actions",[n("v-btn",{attrs:{block:"",color:"secondary"},on:{click:t.handlerClickLogin}},[t._v("Войти")])],1)],1)],1)],1)],1)],1)},re=[],ae={name:"Login",data:function(){return{name:"",valid:!1,rules:{}}},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("auth",["userName"])),Object(l["d"])("settings",["settings"])),created:function(){this.userName&&this.$router.push({name:"main"}),this.initRules()},methods:Object(u["a"])(Object(u["a"])({},Object(l["b"])("auth",["login"])),{},{handlerClickLogin:function(){this.$refs.form.validate(),this.valid&&(this.login(this.name),this.$router.push({name:"main"}))},initRules:function(){this.rules.required=$,this.rules.onlyString=H,this.rules.maxLength=B(this.settings.maxUserNameLength),this.rules.minLength=W(this.settings.minLength)}})},oe=ae,ie=Object(h["a"])(oe,ne,re,!1,null,"0a12e9ea",null),ce=ie.exports;O()(ie,{VBtn:b["a"],VCard:K["a"],VCardActions:et["a"],VCardText:et["b"],VCol:qt["a"],VContainer:Jt["a"],VForm:nt["a"],VMain:Yt["a"],VRow:Kt["a"],VSpacer:rt["a"],VTextField:at["a"],VToolbar:ot["a"],VToolbarTitle:it["a"]}),o["a"].use(I["a"]);var se=[{path:"/",name:"main",component:ee,meta:{requiresAuth:!0}},{path:"/login",name:"login",component:ce},{path:"*",redirect:{name:"main"}}],ue=new I["a"]({mode:"history",base:"/",routes:se}),le=ue,me=(n("99af"),n("4de4"),n("7db0"),n("4160"),n("d81d"),n("159b"),n("2909")),de=n("bc3a"),fe=n.n(de);console.log("https://nane.tada.team");var pe=fe.a.create({baseURL:"https://nane.tada.team"}),he=pe,ve="/api/";function Oe(){return be.apply(this,arguments)}function be(){return be=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,he.get("".concat(ve,"settings"));case 2:return e=t.sent,n=e.data,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),be.apply(this,arguments)}function ge(){return _e.apply(this,arguments)}function _e(){return _e=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,he.get("".concat(ve,"rooms"));case 2:return e=t.sent,n=e.data,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),_e.apply(this,arguments)}function Re(t){return xe.apply(this,arguments)}function xe(){return xe=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,he.get("".concat(ve,"rooms/").concat(e,"/history"));case 2:return n=t.sent,r=n.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)}))),xe.apply(this,arguments)}var we="/ws";function Se(t){return Ce.apply(this,arguments)}function Ce(){return Ce=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="".concat("wss://nane.tada.team").concat(we,"?username=").concat(e),t.next=3,new WebSocket(n);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)}))),Ce.apply(this,arguments)}var Ee,ke,je={main:r,ws:a},ye={defaultBottomSheet:"Точно хотите выйти ?",errorGetSettings:"Не удается загрузить настройки",errorGetHistory:"Не удается загрузить историю",errorGetRooms:"Не удается загрузить комнаты",errorSetRooms:"Не удается создать комнату",createAutoRoom:"Появилась новая комната",createRoom:"Добавленна новая комната",errorGetMessages:"Не удается загрузить сообщения",errorProcessMessages:"Не удается обработать новое сообщения",errorGetInitSocket:"Не удается подключиться по веб сокету",errorSendSocket:"Не удается отправить сообщение по веб сокету",initSocket:"Соединение по веб сокету установленно"},Te=n("d4ec"),Ae=n("bee2"),Ne=function(){function t(e){Object(Te["a"])(this,t),this.room=e.room,this.created=e.created,this.sender=e.sender.username,this.text=e.text}return Object(Ae["a"])(t,[{key:"toJSON",get:function(){return JSON.stringify({room:this.room,text:this.text})}}]),t}(),Ve=function(){function t(e){Object(Te["a"])(this,t),this.name=e.name,this.isActive=!1,this.isCurrent=!1,this.history=[],this.lastMessage=e.last_message?new Ne(e.last_message):null}return Object(Ae["a"])(t,[{key:"addMessagesInHistory",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=this.history).push.apply(t,n),this.lastMessage=n.pop()}}]),t}(),Le={namespaced:!0,state:{rooms:[],currentRoom:null,activeRooms:[]},mutations:{SET_ROOMS:function(t,e){t.rooms=e},ADD_ROOM:function(t,e){t.rooms.push(e)},RESET_ROOMS:function(t){t.currentRoom&&(t.currentRoom.isCurrent=!1),t.currentRoom=null,t.activeRooms.forEach((function(t){return t.isActive=!1})),t.activeRooms=[]},SET_CURRENT_ROOM:function(t,e){t.currentRoom&&(t.currentRoom.isCurrent=!1),e.isCurrent=!0,t.currentRoom=e},ADD_ACTIVE_ROOM:function(t,e){e.isActive=!0,t.activeRooms.push(e)},ADD_NEW_MESSAGE:function(t,e){var n=t.activeRooms.filter((function(t){return t.name===e.room}));n.forEach((function(t){t.addMessagesInHistory(e)}))}},actions:{getRooms:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,e.next=4,je.main.getRooms();case 4:r=e.sent,a=r.result,o=a.map((function(t){return new Ve(t)})),console.info("rooms from api",o),n("SET_ROOMS",o),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](1),Fe.dispatch("notifications/showNotification",{text:ye.errorGetRooms,type:"error"}),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))()},createRoom:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit;try{a=new Ve({name:e}),console.info("new local room",a),r("ADD_ROOM",a),r("ADD_ACTIVE_ROOM",a),r("SET_CURRENT_ROOM",a)}catch(o){Fe.dispatch("notifications/showNotification",{text:ye.errorSetRooms,type:"error"}),console.error(o)}case 2:case"end":return n.stop()}}),n)})))()},createAutoRoom:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit;try{a=new Ve({name:e.room}),a.lastMessage=e,console.info("new auto room from api",a),r("ADD_ROOM",a),Fe.dispatch("notifications/showNotification",{text:"".concat(ye.createAutoRoom," ").concat(a.name)})}catch(o){Fe.dispatch("notifications/showNotification",{text:ye.errorSetRooms,type:"error"}),console.error(o)}case 2:case"end":return n.stop()}}),n)})))()},processNewMessage:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,a=t.dispatch,o=t.state;try{i=new Ne(JSON.parse(e)),console.info("new messages ",i),c=o.rooms.find((function(t){return t.name===i.room})),c?r("ADD_NEW_MESSAGE",i):a("createAutoRoom",i)}catch(s){Fe.dispatch("notifications/showNotification",{text:ye.errorProcessMessages,type:"error"}),console.error(s)}case 2:case"end":return n.stop()}}),n)})))()},getHistory:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.commit,n.prev=1,n.next=4,je.main.getHistory(e);case 4:return r=n.sent,a=r.result,o=a.map((function(t){return new Ne(t)})),console.info("message for ".concat(e),o),n.abrupt("return",o);case 11:n.prev=11,n.t0=n["catch"](1),Fe.dispatch("notifications/showNotification",{text:ye.errorGetHistory,type:"error"}),console.error(n.t0);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))()},initActiveRoom:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.commit,a=t.dispatch,n.prev=1,!e.isActive){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,a("getHistory",e.name);case 6:o=n.sent,e.addMessagesInHistory.apply(e,Object(me["a"])(o)),r("ADD_ACTIVE_ROOM",e),r("SET_CURRENT_ROOM",e),n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](1),Fe.dispatch("notifications/showNotification",{text:ye.errorGetMessages,type:"error"}),console.error(n.t0);case 16:case"end":return n.stop()}}),n,null,[[1,12]])})))()}}},Me=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(Te["a"])(this,t),this.maxMessageLength=e.max_message_length||10500,this.maxRoomTitleLength=e.max_room_title_length||50,this.maxUserNameLength=e.max_username_length||50,this.minLength=5,this.uptime=e.uptime},Ie={namespaced:!0,state:{settings:null},mutations:{SET_SETTINGS:function(t,e){t.settings=e}},actions:{getSettings:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,e.next=4,je.main.getConfig();case 4:a=e.sent,o=a.result,r=new Me(o),e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](1),r=new Me,Fe.dispatch("notifications/showNotification",{text:ye.errorGetSettings,type:"error"}),console.error(e.t0);case 14:return e.prev=14,console.info("settings from api",r),n("SET_SETTINGS",r),e.finish(14);case 18:case"end":return e.stop()}}),e,null,[[1,9,14,18]])})))()}}},De=(n("c740"),n("a434"),n("d3b7"),4e3),Ge="secondary",Pe={namespaced:!0,state:{count:0,notifications:[],userAction:null},mutations:{INCREMENT_COUNT:function(t){t.count++},ADD_NOTIFICATION:function(t,e){t.notifications.unshift(e)},DELETE_NOTIFICATION:function(t,e){var n=t.notifications.findIndex((function(t){return t.id===e.id}));-1!==n&&t.notifications.splice(n,1)},SET_USER_ACTION:function(t,e){t.userAction=e}},actions:{showNotification:function(t,e){var n=t.commit,r=t.state,a=e.type,o=e.text,i=void 0===o?"":o,c=Ge;"error"===a&&(c="error");var s={text:i,color:c,id:r.count};n("ADD_NOTIFICATION",s),setTimeout((function(){n("DELETE_NOTIFICATION",s)}),De),n("INCREMENT_COUNT")},confirmUserAction:function(t){var e=t.commit,n=(t.state,arguments.length>1&&void 0!==arguments[1]?arguments[1]:ye.defaultBottomSheet),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ue.DELETE;return new Promise((function(t){Ee=t,e("SET_USER_ACTION",{type:r,text:n})}))},resolveConfirmUserAction:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,t.state,r("SET_USER_ACTION",null),Ee(e);case 3:case"end":return n.stop()}}),n)})))()}}},Ue={DELETE:"delete"},$e={namespaced:!0,state:{isShowCreateRoom:!1,isShowDrawer:!1},mutations:{TOGGLE_SHOW_CREATE_ROOM:function(t,e){t.isShowCreateRoom=e},TOGGLE_SHOW_DRAWER:function(t,e){t.isShowDrawer=e}}},He="userName",We={namespaced:!0,state:{userName:null},mutations:{LOGIN:function(t,e){t.userName=e},LOGOUT:function(t){t.userName=null}},actions:{login:function(t,e){var n=t.commit;return localStorage.setItem(He,e),n("LOGIN",e),e},logout:function(t){var e=t.commit;localStorage.removeItem(He),e("LOGOUT")},checkAuth:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dispatch,e.next=3,localStorage.getItem(He);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))()}}},Be={namespaced:!0,state:{isConnect:!1},mutations:{SET_IS_CONNECT:function(t,e){t.isConnect=e}},actions:{connectSocket:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,a=t.dispatch,n.prev=1,n.next=4,je.ws.getSocket(e);case 4:return o=n.sent,n.next=7,new Promise((function(t){o.onopen=function(){o.onmessage=function(t){Fe.dispatch("rooms/processNewMessage",t.data)},ke=o,Fe.dispatch("notifications/showNotification",{text:ye.initSocket}),t()}}));case 7:r("SET_IS_CONNECT",!0),n.next=15;break;case 10:n.prev=10,n.t0=n["catch"](1),a("disconnectSocket"),Fe.dispatch("notifications/showNotification",{text:ye.errorGetInitSocket,type:"error"}),console.error(n.t0);case 15:case"end":return n.stop()}}),n,null,[[1,10]])})))()},sendSocket:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.commit,t.state,n.prev=1,e=JSON.stringify(e),n.next=5,ke.send(e);case 5:n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](1),Fe.dispatch("notifications/showNotification",{text:ye.errorSendSocket,type:"error"}),console.error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,7]])})))()},disconnectSocket:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,e.next=4,ke.close();case 4:n("SET_IS_CONNECT",!1),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))()}}};o["a"].use(l["a"]);var Fe=new l["a"].Store({modules:{rooms:Le,settings:Ie,notifications:Pe,modals:$e,auth:We,socket:Be}}),qe=n("f309"),Je=n("0879"),Ye=n("fcf4");o["a"].use(qe["a"]);var Ke=new qe["a"]({theme:{themes:{light:{primary:Object({NODE_ENV:"production",VUE_APP_API_BASE_URL:"https://nane.tada.team",VUE_APP_SOCKET_BASE_URL:"wss://nane.tada.team",VUE_APP_PRIMARY_COLOR2:"#009688",VUE_APP_SECONDARY_COLOR2:"green",BASE_URL:"/"}).VUE_APP_PRIMARY_COLOR||Ye["a"].teal,secondary:Object({NODE_ENV:"production",VUE_APP_API_BASE_URL:"https://nane.tada.team",VUE_APP_SOCKET_BASE_URL:"wss://nane.tada.team",VUE_APP_PRIMARY_COLOR2:"#009688",VUE_APP_SECONDARY_COLOR2:"green",BASE_URL:"/"}).VUE_APP_SECONDARY_COLOR||Ye["a"].teal.lighten2,accent:Ye["a"].indigo.base}}},lang:{locales:{ru:Je["a"]},current:"ru"}});o["a"].config.productionTip=!1,new o["a"]({router:le,store:Fe,vuetify:Ke,render:function(t){return t(M)}}).$mount("#app")},bc04:function(t,e,n){},db2c:function(t,e,n){}});
//# sourceMappingURL=app.f7c0fd2c.js.map