(function(t){function e(e){for(var r,i,c=e[0],s=e[1],u=e[2],m=0,d=[];m<c.length;m++)i=c[m],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=s;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"124f":function(t,e,n){},"262d":function(t,e,n){"use strict";var r=n("4db4"),a=n.n(r);a.a},"4db4":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"getConfig",(function(){return Se})),n.d(r,"getRooms",(function(){return Ee})),n.d(r,"getHistory",(function(){return Ce}));var a={};n.r(a),n.d(a,"getSocket",(function(){return Le}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("nane-top-system-bar"),n("transition",{attrs:{appear:"",mode:"out-in",name:"opacity-fade"}},[t.loading?n("v-progress-circular",{staticClass:"ma-auto",attrs:{size:"280",color:"primary",width:"12",indeterminate:""}}):n("router-view")],1),n("nane-notifications"),n("nane-bottom-sheet")],1)},c=[],s=(n("b0c0"),n("96cf"),n("1da1")),u=n("5530"),l=n("2f62"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("transition-group",{attrs:{appear:"",mode:"out-in",name:"slide-fade"}},t._l(t.notifications,(function(e,r){return n("v-snackbar",{key:e.id,style:{top:t.widthSnackbar*r+"px"},attrs:{top:"",right:"",color:e.color,timeout:6e4,value:e},scopedSlots:t._u([{key:"action",fn:function(){return[n("v-btn",{attrs:{text:""},on:{click:function(n){return t.DELETE_NOTIFICATION(e)}}},[t._v(" Закрыть ")])]},proxy:!0}],null,!0)},[t._v(" "+t._s(e.text)+" ")])})),1)],1)},d=[],f={name:"NaneNotifications",data:function(){return{widthSnackbar:55}},computed:Object(u["a"])({},Object(l["d"])("notifications",["notifications"])),methods:Object(u["a"])({},Object(l["c"])("notifications",["DELETE_NOTIFICATION"]))},p=f,h=(n("262d"),n("2877")),v=n("6544"),_=n.n(v),O=n("8336"),b=n("2db4"),g=Object(h["a"])(p,m,d,!1,null,"bcf20030",null),R=g.exports;_()(g,{VBtn:O["a"],VSnackbar:b["a"]});var w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-bottom-sheet",{attrs:{value:!!t.userAction,persistent:"",inset:""}},[n("v-sheet",{staticClass:"text-center py-8"},[t.userAction?n("p",{staticClass:"text-h6"},[t._v(t._s(t.userAction.text))]):t._e(),n("v-btn",{staticClass:"mx-2",attrs:{width:"120px",color:"secondary"},on:{click:function(e){return t.handlerClickConfirm(!0)}}},[t._v("да")]),n("v-btn",{staticClass:"mx-2",attrs:{width:"120px",outlined:"",color:"error"},on:{click:function(e){return t.handlerClickConfirm(!1)}}},[t._v("нет")])],1)],1)},S=[],x={name:"NaneBottomSheet",data:function(){return{}},computed:Object(u["a"])({},Object(l["d"])("notifications",["userAction"])),methods:Object(u["a"])(Object(u["a"])({},Object(l["b"])("notifications",["resolveConfirmUserAction"])),{},{handlerClickConfirm:function(t){this.resolveConfirmUserAction(t)}})},E=x,k=n("288c"),C=n("8dd9"),y=Object(h["a"])(E,w,S,!1,null,"4a8f66be",null),j=y.exports;_()(y,{VBottomSheet:k["a"],VBtn:O["a"],VSheet:C["a"]});var T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isShowTopSystemBar?n("v-system-bar",{attrs:{app:"",color:"grey lighten-1"}},[n("v-spacer"),n("span",[t._v("Нет подключения к интернету")]),n("v-icon",{staticClass:"ml-2"},[t._v("mdi-wifi-off")]),n("v-spacer")],1):t._e()},A=[],N={name:"NaneTopSystemBar",data:function(){return{}},computed:Object(u["a"])({},Object(l["d"])("notifications",["isShowTopSystemBar"]))},V=N,L=n("132d"),M=n("2fa4"),I=n("afd9"),P=Object(h["a"])(V,T,A,!1,null,"17ae5e31",null),U=P.exports;_()(P,{VIcon:L["a"],VSpacer:M["a"],VSystemBar:I["a"]});var D={name:"App",data:function(){return{loading:!0}},components:{NaneNotifications:R,NaneBottomSheet:j,NaneTopSystemBar:U},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["b"])("rooms",["getRooms"])),Object(l["b"])("settings",["getSettings"])),Object(l["b"])("auth",["checkAuth","login"])),Object(l["b"])("notifications",["initWatchIsOnline"])),created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.initWatchIsOnline(),e.next=4,t.getSettings();case 4:return e.next=6,t.getRooms();case 6:return e.next=8,t.checkAuth();case 8:n=e.sent,n?t.login(n):(r="login",t.$route.name!==r&&t.$router.push({name:r}));case 10:return e.prev=10,t.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,,10,13]])})))()}},G=D,B=(n("ac0c"),n("7496")),$=n("490a"),W=Object(h["a"])(G,i,c,!1,null,"7f387f40",null),H=W.exports;_()(W,{VApp:B["a"],VProgressCircular:$["a"]});var F=n("8c4f"),q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("main-header"),n("main-sidebar"),n("main-drawer"),n("main-chat"),n("main-modal-creat-room")],1)},Y=[],J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nane-modal",{attrs:{value:t.isShowCreateRoom},on:{cancel:function(e){return t.TOGGLE_SHOW_CREATE_ROOM(!1)}}},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[n("v-toolbar-title",[t._v("Имя нового чата")]),n("v-spacer")],1),n("v-card-text",{staticClass:"pt-5"},[n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{counter:t.settings.maxRoomTitleLength,rules:[t.rules.required,t.rules.onlyString,t.rules.maxLength],clearable:"",autocomplete:"off","prepend-icon":"mdi-comment-processing-outline",type:"text"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.handlerClickCreate(e))}},model:{value:t.nameRoom,callback:function(e){t.nameRoom="string"===typeof e?e.trim():e},expression:"nameRoom"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{width:"120px",color:"secondary"},on:{click:t.handlerClickCreate}},[t._v("Создать")]),n("v-btn",{attrs:{width:"120px",outlined:"",color:"error"},on:{click:t.handlerClickClose}},[t._v("Закрыть")])],1)],1)},K=[],z=(n("498a"),function(t){return!!t&&!!t.trim()||"Это поле обязательно"}),Q=function(t){return"string"===typeof t||"Это поле только для строк"},X=function(t){return function(e){return!!e&&e.length<=t||"Максимальное количество символов "+t}},Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{value:t.value,"max-width":800},on:{"click:outside":t.handlerClickCancel,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.handlerClickCancel(e)}}},[n("v-card",{staticClass:"elevation-12"},[t._t("default")],2)],1)},tt=[],et={name:"NaneModal",data:function(){return{}},props:{value:{type:Boolean,default:!1}},methods:{handlerClickCancel:function(){this.$emit("cancel")}}},nt=et,rt=n("b0af"),at=n("169a"),ot=Object(h["a"])(nt,Z,tt,!1,null,"5d8fd403",null),it=ot.exports;_()(ot,{VCard:rt["a"],VDialog:at["a"]});var ct={name:"MainModalCreateRoom",data:function(){return{nameRoom:"",valid:!1,rules:{}}},components:{NaneModal:it},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("settings",["settings"])),Object(l["d"])("modals",["isShowCreateRoom"])),created:function(){this.initRules()},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["c"])("modals",["TOGGLE_SHOW_CREATE_ROOM"])),Object(l["b"])("rooms",["createRoom"])),{},{handlerClickCreate:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$refs.form.validate(),t.valid){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,t.createRoom(t.nameRoom);case 6:return e.prev=6,t.handlerClickClose(),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[3,,6,9]])})))()},handlerClickClose:function(){this.$refs.form.reset(),this.TOGGLE_SHOW_CREATE_ROOM(!1)},initRules:function(){this.rules.required=z,this.rules.onlyString=Q,this.rules.maxLength=X(this.settings.maxRoomTitleLength)}})},st=ct,ut=n("99d9"),lt=n("4bd4"),mt=n("8654"),dt=n("71d9"),ft=n("2a7f"),pt=Object(h["a"])(st,J,K,!1,null,"609aea29",null),ht=pt.exports;_()(pt,{VBtn:O["a"],VCardActions:ut["a"],VCardText:ut["b"],VForm:lt["a"],VSpacer:M["a"],VTextField:mt["a"],VToolbar:dt["a"],VToolbarTitle:ft["a"]});var vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app-bar",{attrs:{app:"",fixed:"","clipped-left":"",color:"primary",dark:""}},[n("v-toolbar-title",[t._v("Сега Мега Ай-нане чат !!")]),n("v-spacer"),n("v-icon",{staticClass:"mr-2"},[t._v("mdi-comment-account-outline")]),n("v-toolbar-title",{staticClass:"font-weight-bold text-h5 text-uppercase "},[t._v(" "+t._s(t.userName)+" ")]),n("v-spacer"),n("v-btn",{staticClass:"ma-2",attrs:{outlined:"",dark:"",disabled:t.isLoading,loading:t.isLoading},on:{click:t.handlerClickLogout}},[t._v(" выход "),n("v-icon",{attrs:{right:""}},[t._v("mdi-exit-to-app")])],1)],1)},_t=[],Ot={name:"MainHeader",data:function(){return{isLoading:!1}},computed:Object(u["a"])({},Object(l["d"])("auth",["userName"])),methods:Object(u["a"])(Object(u["a"])(Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["b"])("auth",["logout"])),Object(l["b"])("socket",["disconnectSocket"])),Object(l["c"])("rooms",["RESET_ROOMS"])),Object(l["b"])("notifications",["confirmUserAction"])),{},{handlerClickLogout:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.confirmUserAction();case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:t.isLoading=!0;try{t.disconnectSocket(),t.logout(),t.RESET_ROOMS(),t.$router.push({name:"login"})}finally{t.isLoading=!1}case 7:case"end":return e.stop()}}),e)})))()}})},bt=Ot,gt=n("40dc"),Rt=Object(h["a"])(bt,vt,_t,!1,null,"7e389ef8",null),wt=Rt.exports;_()(Rt,{VAppBar:gt["a"],VBtn:O["a"],VIcon:L["a"],VSpacer:M["a"],VToolbarTitle:ft["a"]});var St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-navigation-drawer",{attrs:{width:"400px",value:t.isShowDrawer,fixed:"",temporary:""},on:{input:function(e){return t.TOGGLE_SHOW_DRAWER(e)}},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("v-list-item",{staticClass:"text-center mt-2"},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"text-uppercase font-weight-medium"},[t._v("Список чатов")])],1),t.$vuetify.breakpoint.xs?n("v-btn",{attrs:{fab:"",small:"",text:""},on:{click:function(e){return t.TOGGLE_SHOW_DRAWER(!1)}}},[n("v-icon",{attrs:{large:""}},[t._v("close")])],1):t._e()],1),n("v-divider")]},proxy:!0}])},[n("v-list",{attrs:{inlist:"",subheader:"","three-line":""}},[t._l(t.rooms,(function(e,r){return[n("v-list-item",{key:r,class:{"grey lighten-2":e.isActive},on:{click:function(n){return n.stopPropagation(),t.handlerClickRoom(e)}}},[n("v-list-item-content",{},[n("v-list-item-title",[t._v(" "+t._s(e.name)+" ")]),e.lastMessage?n("v-list-item-subtitle",{staticClass:"caption"},[t._v(" «"+t._s(e.lastMessage.text)+"» ")]):t._e()],1),n("v-list-item-icon",{staticClass:"pt-4"},[e.isActive?n("v-icon",{attrs:{color:"primary "}},[t._v("star")]):t._e()],1)],1),n("v-divider",{key:r+"x"})]}))],2)],1)},xt=[],Et={name:"MainDrawer",data:function(){return{}},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("modals",["isShowDrawer"])),Object(l["d"])("rooms",["rooms"])),methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["c"])("modals",["TOGGLE_SHOW_DRAWER"])),Object(l["b"])("rooms",["initActiveRoom"])),{},{handlerClickRoom:function(t){this.TOGGLE_SHOW_DRAWER(!1),t.isActive||this.initActiveRoom(t)}})},kt=Et,Ct=n("ce7e"),yt=n("8860"),jt=n("da13"),Tt=n("5d23"),At=n("34c3"),Nt=n("f774"),Vt=Object(h["a"])(kt,St,xt,!1,null,"c77ffb22",null),Lt=Vt.exports;_()(Vt,{VBtn:O["a"],VDivider:Ct["a"],VIcon:L["a"],VList:yt["a"],VListItem:jt["a"],VListItemContent:Tt["a"],VListItemIcon:At["a"],VListItemSubtitle:Tt["b"],VListItemTitle:Tt["c"],VNavigationDrawer:Nt["a"]});var Mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-navigation-drawer",{attrs:{width:t.$vuetify.breakpoint.xs?150:270,clipped:"",permanent:"","disable-resize-watcher":"",app:""},scopedSlots:t._u([{key:"prepend",fn:function(){return[n("v-list-item",{on:{click:function(e){return e.stopPropagation(),t.TOGGLE_SHOW_DRAWER(!0)}}},[n("v-list-item-content",[n("v-list-item-title",[t._v("Выбрать чат")])],1),n("v-list-item-action",[n("v-icon",[t._v("mdi-comment-multiple-outline")])],1)],1),n("v-list-item",{on:{click:function(e){return e.stopPropagation(),t.TOGGLE_SHOW_CREATE_ROOM(!0)}}},[n("v-list-item-content",[n("v-list-item-title",[t._v("Создать чат")])],1),n("v-list-item-action",[n("v-icon",[t._v("mdi-comment-plus-outline")])],1)],1),n("v-divider")]},proxy:!0}])},[n("v-list",{attrs:{dense:""}},t._l(t.activeRooms,(function(e,r){return n("v-list-item",{key:r,class:{secondary:e.isCurrent},on:{click:function(n){return n.stopPropagation(),t.handlerClickRoom(e)}}},[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(e.name))])],1),n("v-list-item-action",[e.isCurrent?n("v-icon",[t._v("mdi-comment-check-outline")]):t._e()],1)],1)})),1)],1)},It=[],Pt={name:"MainSidebar",data:function(){return{}},computed:Object(u["a"])({},Object(l["d"])("rooms",["activeRooms"])),methods:Object(u["a"])(Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["c"])("modals",["TOGGLE_SHOW_DRAWER"])),Object(l["c"])("modals",["TOGGLE_SHOW_CREATE_ROOM"])),Object(l["c"])("rooms",["SET_CURRENT_ROOM"])),{},{handlerClickRoom:function(t){this.SET_CURRENT_ROOM(t)}})},Ut=Pt,Dt=n("1800"),Gt=Object(h["a"])(Ut,Mt,It,!1,null,"5ac214ce",null),Bt=Gt.exports;_()(Gt,{VDivider:Ct["a"],VIcon:L["a"],VList:yt["a"],VListItem:jt["a"],VListItemAction:Dt["a"],VListItemContent:Tt["a"],VListItemTitle:Tt["c"],VNavigationDrawer:Nt["a"]});var $t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-main",[n("v-container",{staticClass:"fill-height pa-0",attrs:{fluid:""}},[t.currentRoom?n("div",{staticClass:"wrapper"},[n("div",{ref:"chat",staticClass:"chat"},[n("v-row",{attrs:{"no-gutters":""}},t._l(t.currentRoom.history,(function(t,e){return n("v-col",{key:e,attrs:{cols:"12"}},[n("message",{attrs:{msg:t}})],1)})),1)],1),n("div",{staticClass:"input-send"},[n("v-row",{staticClass:"pa-3 pt-5",attrs:{dense:"",align:"start"}},[n("v-col",{attrs:{cols:""}},[n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{clearable:"",autocomplete:"off",type:"text",counter:t.settings.maxMessageLength,rules:[t.rules.required,t.rules.onlyString,t.rules.maxLength],placeholder:"Ваше сообщение",outlined:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.handleClickSend(e))}},model:{value:t.msgText,callback:function(e){t.msgText="string"===typeof e?e.trim():e},expression:"msgText"}})],1)],1),n("v-col",{attrs:{cols:"auto"}},[n("v-btn",{attrs:{"x-large":"",color:"primary"},on:{click:t.handleClickSend}},[n("v-icon",{attrs:{large:""}},[t._v("mdi-send")])],1)],1)],1)],1)]):n("p",{staticClass:"hint text-center body-1 grey--text text--lighten-1"},[t._v("Нет выбранного чата...")])])],1)},Wt=[],Ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticClass:"ma-2 ",class:{"align-self-end":t.isSudo},attrs:{width:"70%",color:t.isSudo?"grey lighten-1 ml-auto":"grey lighten-3",dark:t.isSudo}},[n("v-card-title",{staticClass:"body-2 pa-2"},[t.isSudo?t._e():n("v-icon",{staticClass:"mr-2"},[t._v("mdi-account")]),t._v(" "+t._s(t.msg.sender)+" ")],1),n("v-card-text",{staticClass:"body-2 pa-2"},[t._v(t._s(t.msg.text))])],1)},Ft=[],qt={name:"Message",data:function(){return{}},props:{msg:{type:Object,required:!0}},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("auth",["userName"])),{},{isSudo:function(){return this.msg.sender===this.userName}})},Yt=qt,Jt=Object(h["a"])(Yt,Ht,Ft,!1,null,"6d2a2a18",null),Kt=Jt.exports;_()(Jt,{VCard:rt["a"],VCardText:ut["b"],VCardTitle:ut["c"],VIcon:L["a"]});var zt={name:"MainChat",data:function(){return{msgText:"",valid:!1,rules:{}}},components:{Message:Kt},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("rooms",["currentRoom"])),Object(l["d"])("settings",["settings"])),watch:{"currentRoom.history":function(){this.scrollToBottom()}},created:function(){this.initRules()},methods:Object(u["a"])(Object(u["a"])({},Object(l["b"])("socket",["sendSocket"])),{},{scrollToBottom:function(){var t=this;this.$nextTick((function(){var e=t.$refs.chat;e.scrollTop=e.scrollHeight}))},handleClickSend:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$refs.form.validate(),t.valid){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,t.sendSocket({room:t.currentRoom.name,text:t.msgText});case 6:t.$refs.form.reset(),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](3),console.dir(e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})))()},initRules:function(){this.rules.required=z,this.rules.onlyString=Q,this.rules.maxLength=X(this.settings.maxMessageLength)}})},Qt=zt,Xt=(n("f90b"),n("62ad")),Zt=n("a523"),te=n("f6c4"),ee=n("0fd9"),ne=Object(h["a"])(Qt,$t,Wt,!1,null,"c8f4e8a2",null),re=ne.exports;_()(ne,{VBtn:O["a"],VCol:Xt["a"],VContainer:Zt["a"],VForm:lt["a"],VIcon:L["a"],VMain:te["a"],VRow:ee["a"],VTextField:mt["a"]});var ae={name:"Main",data:function(){return{}},components:{MainModalCreatRoom:ht,MainHeader:wt,MainDrawer:Lt,MainSidebar:Bt,MainChat:re},computed:Object(u["a"])({},Object(l["d"])("auth",["userName"])),created:function(){this.init()},methods:Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(l["c"])("modals",["TOGGLE_SHOW_CREATE_ROOM"])),Object(l["b"])("socket",["connectSocket","sendSocket"])),{},{init:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.userName){e.next=5;break}return e.next=3,t.connectSocket(t.userName);case 3:e.next=6;break;case 5:t.$router.push({name:"login"});case 6:case"end":return e.stop()}}),e)})))()}})},oe=ae,ie=Object(h["a"])(oe,q,Y,!1,null,"099ff172",null),ce=ie.exports;_()(ie,{VApp:B["a"]});var se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-main",[n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",md:"4",sm:"8"}},[n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[n("v-toolbar-title",[t._v("Ваше имя")]),n("v-spacer")],1),n("v-card-text",[n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{attrs:{rules:[t.rules.required,t.rules.onlyString,t.rules.maxLength],counter:t.settings.maxUserNameLength,clearable:"",autocomplete:"off","prepend-icon":"mdi-account",type:"text"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.handlerClickLogin(e))}},model:{value:t.name,callback:function(e){t.name="string"===typeof e?e.trim():e},expression:"name"}})],1)],1),n("v-card-actions",[n("v-btn",{attrs:{block:"",color:"secondary"},on:{click:t.handlerClickLogin}},[t._v("Войти")])],1)],1)],1)],1)],1)],1)},ue=[],le={name:"Login",data:function(){return{name:"",valid:!1,rules:{}}},computed:Object(u["a"])(Object(u["a"])({},Object(l["d"])("auth",["userName"])),Object(l["d"])("settings",["settings"])),created:function(){this.userName&&this.$router.push({name:"main"}),this.initRules()},methods:Object(u["a"])(Object(u["a"])({},Object(l["b"])("auth",["login"])),{},{handlerClickLogin:function(){this.$refs.form.validate(),this.valid&&(this.login(this.name),this.$router.push({name:"main"}))},initRules:function(){this.rules.required=z,this.rules.onlyString=Q,this.rules.maxLength=X(this.settings.maxUserNameLength)}})},me=le,de=Object(h["a"])(me,se,ue,!1,null,"084bda47",null),fe=de.exports;_()(de,{VBtn:O["a"],VCard:rt["a"],VCardActions:ut["a"],VCardText:ut["b"],VCol:Xt["a"],VContainer:Zt["a"],VForm:lt["a"],VMain:te["a"],VRow:ee["a"],VSpacer:M["a"],VTextField:mt["a"],VToolbar:dt["a"],VToolbarTitle:ft["a"]}),o["a"].use(F["a"]);var pe=[{path:"/",name:"main",component:ce,meta:{requiresAuth:!0}},{path:"/login",name:"login",component:fe},{path:"*",redirect:{name:"main"}}],he=new F["a"]({mode:"history",base:"/sega_mega_chat",routes:pe}),ve=he,_e=(n("99af"),n("4de4"),n("7db0"),n("4160"),n("d81d"),n("159b"),n("2909")),Oe=n("bc3a"),be=n.n(Oe),ge=be.a.create({baseURL:"https://nane.tada.team"}),Re=ge,we="/api/";function Se(){return xe.apply(this,arguments)}function xe(){return xe=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Re.get("".concat(we,"settings"));case 2:return e=t.sent,n=e.data,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),xe.apply(this,arguments)}function Ee(){return ke.apply(this,arguments)}function ke(){return ke=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Re.get("".concat(we,"rooms"));case 2:return e=t.sent,n=e.data,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),ke.apply(this,arguments)}function Ce(t){return ye.apply(this,arguments)}function ye(){return ye=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Re.get("".concat(we,"rooms/").concat(e,"/history"));case 2:return n=t.sent,r=n.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)}))),ye.apply(this,arguments)}n("d3b7");var je=n("d4ec"),Te=n("bee2"),Ae={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},Ne=function(){function t(e){var n=e.url,r=e.reconnection,a=void 0!==r&&r,o=e.reconnectionTime,i=void 0===o?1e3:o,c=e.reconnectionAttempts,s=void 0===c?5:c;if(Object(je["a"])(this,t),!n)throw new Error("url is required");this._ws=null,this.url=n,this.reconnection=a,this.reconnectionTime=i,this.countReconnect=0,this.reconnectionAttempts=s,this.isActive=!1,this.onmessage=function(){}}return Object(Te["a"])(t,[{key:"connect",value:function(){var t=this;return new Promise((function(e,n){var r=function(){var n=Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t._ws&&t.disconnect(),t._ws=new WebSocket(t.url),t._ws.onopen=function(){console.warn("SocketCustom connect"),e()},t._ws.onmessage=function(e){t.onmessage(e.data)},t._ws.onclose=function(){t.reconnection&&setTimeout(r,t.reconnectionTime)};case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();r()}))}},{key:"send",value:function(t){if(!this._ws||this._ws.readyState!==Ae.OPEN)throw new Error("SocketCustom is already");this._ws.send(t)}},{key:"disconnect",value:function(){var t=this;return new Promise((function(e){t._ws.onclose=function(){console.warn("SocketCustom disconnect"),e()},t._ws.close()}))}}]),t}(),Ve="/ws";function Le(t){if(!t)throw new Error("user name is required");return new Ne({url:"".concat("wss://nane.tada.team").concat(Ve,"?username=").concat(t),reconnection:!0})}var Me,Ie,Pe={main:r,ws:a},Ue={defaultBottomSheet:"Точно хотите выйти ?",errorGetSettings:"Не удается загрузить настройки",errorGetHistory:"Не удается загрузить историю",errorGetRooms:"Не удается загрузить комнаты",errorSetRooms:"Не удается создать комнату",createAutoRoom:"Появилась новая комната",createRoom:"Добавленна новая комната",errorGetMessages:"Не удается загрузить сообщения",errorProcessMessages:"Не удается обработать новое сообщения",errorGetInitSocket:"Не удается подключиться по веб сокету",errorSendSocket:"Не удается отправить сообщение по веб сокету",initSocket:"Соединение по веб сокету установленно"},De=function(){function t(e){Object(je["a"])(this,t),this.room=e.room,this.created=e.created,this.sender=e.sender.username,this.text=e.text}return Object(Te["a"])(t,[{key:"toJSON",get:function(){return JSON.stringify({room:this.room,text:this.text})}}]),t}(),Ge=function(){function t(e){Object(je["a"])(this,t),this.name=e.name,this.isActive=!1,this.isCurrent=!1,this.history=[],this.lastMessage=e.last_message?new De(e.last_message):null}return Object(Te["a"])(t,[{key:"addMessagesInHistory",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=this.history).push.apply(t,n),this.lastMessage=n.pop()}}]),t}(),Be={namespaced:!0,state:{rooms:[],currentRoom:null,activeRooms:[]},mutations:{SET_ROOMS:function(t,e){t.rooms=e},ADD_ROOM:function(t,e){t.rooms.push(e)},RESET_ROOMS:function(t){t.currentRoom&&(t.currentRoom.isCurrent=!1),t.currentRoom=null,t.activeRooms.forEach((function(t){return t.isActive=!1})),t.activeRooms=[]},SET_CURRENT_ROOM:function(t,e){t.currentRoom&&(t.currentRoom.isCurrent=!1),e.isCurrent=!0,t.currentRoom=e},ADD_ACTIVE_ROOM:function(t,e){e.isActive=!0,t.activeRooms.push(e)},ADD_NEW_MESSAGE:function(t,e){var n=t.activeRooms.filter((function(t){return t.name===e.room}));n.forEach((function(t){t.addMessagesInHistory(e)}))}},actions:{getRooms:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,e.next=4,Pe.main.getRooms();case 4:r=e.sent,a=r.result,o=a.map((function(t){return new Ge(t)})),console.info("rooms from api",o),n("SET_ROOMS",o),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](1),Xe.dispatch("notifications/showNotification",{text:Ue.errorGetRooms,type:"error"}),console.warn(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))()},createRoom:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,n.prev=1,a=new Ge({name:e}),console.info("new local room",a),r("ADD_ROOM",a),r("ADD_ACTIVE_ROOM",a),r("SET_CURRENT_ROOM",a),n.next=14;break;case 9:throw n.prev=9,n.t0=n["catch"](1),Xe.dispatch("notifications/showNotification",{text:Ue.errorSetRooms,type:"error"}),console.warn(n.t0),n.t0;case 14:case"end":return n.stop()}}),n,null,[[1,9]])})))()},createAutoRoom:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit;try{a=new Ge({name:e.room}),a.lastMessage=e,console.info("new auto room from api",a),r("ADD_ROOM",a),Xe.dispatch("notifications/showNotification",{text:"".concat(Ue.createAutoRoom," ").concat(a.name)})}catch(o){Xe.dispatch("notifications/showNotification",{text:Ue.errorSetRooms,type:"error"}),console.warn(o)}case 2:case"end":return n.stop()}}),n)})))()},processNewMessage:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,a=t.dispatch,o=t.state;try{i=new De(JSON.parse(e)),console.info("new messages ",i),c=o.rooms.find((function(t){return t.name===i.room})),c?r("ADD_NEW_MESSAGE",i):a("createAutoRoom",i)}catch(s){Xe.dispatch("notifications/showNotification",{text:Ue.errorProcessMessages,type:"error"}),console.warn(s)}case 2:case"end":return n.stop()}}),n)})))()},getHistory:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.commit,n.prev=1,e.lastMessage){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,Pe.main.getHistory(e.name);case 6:r=n.sent,a=r.result,o=a.map((function(t){return new De(t)})),e.addMessagesInHistory.apply(e,Object(_e["a"])(o)),console.info("message for ".concat(e.name),o),n.next=17;break;case 13:n.prev=13,n.t0=n["catch"](1),Xe.dispatch("notifications/showNotification",{text:Ue.errorGetHistory,type:"error"}),console.warn(n.t0);case 17:case"end":return n.stop()}}),n,null,[[1,13]])})))()},initActiveRoom:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.commit,a=t.dispatch,n.prev=1,!e.isActive){n.next=4;break}return n.abrupt("return");case 4:return r("ADD_ACTIVE_ROOM",e),r("SET_CURRENT_ROOM",e),n.next=8,a("getHistory",e);case 8:n.next=15;break;case 10:throw n.prev=10,n.t0=n["catch"](1),Xe.dispatch("notifications/showNotification",{text:Ue.errorGetMessages,type:"error"}),console.warn(n.t0),n.t0;case 15:case"end":return n.stop()}}),n,null,[[1,10]])})))()}}},$e=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(je["a"])(this,t),this.maxMessageLength=e.max_message_length||10500,this.maxRoomTitleLength=e.max_room_title_length||50,this.maxUserNameLength=e.max_username_length||50,this.minLength=e.min_length||1,this.uptime=e.uptime},We={namespaced:!0,state:{settings:null},mutations:{SET_SETTINGS:function(t,e){t.settings=e}},actions:{getSettings:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,e.next=4,Pe.main.getConfig();case 4:a=e.sent,o=a.result,r=new $e(o),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),r=new $e,Xe.dispatch("notifications/showNotification",{text:Ue.errorGetSettings,type:"error"});case 13:return e.prev=13,console.info("settings from api",r),n("SET_SETTINGS",r),e.finish(13);case 17:case"end":return e.stop()}}),e,null,[[1,9,13,17]])})))()}}},He=(n("c740"),n("a434"),4e3),Fe="secondary",qe={namespaced:!0,state:{count:0,notifications:[],userAction:null,isShowTopSystemBar:!1},mutations:{INCREMENT_COUNT:function(t){t.count++},ADD_NOTIFICATION:function(t,e){t.notifications.unshift(e)},DELETE_NOTIFICATION:function(t,e){var n=t.notifications.findIndex((function(t){return t.id===e.id}));-1!==n&&t.notifications.splice(n,1)},SET_USER_ACTION:function(t,e){t.userAction=e},TOGGLE_SHOW_TOP_SYSTEM_BAR:function(t,e){t.isShowTopSystemBar=e}},actions:{initWatchIsOnline:function(t){var e=t.commit,n=(t.state,function(){e("TOGGLE_SHOW_TOP_SYSTEM_BAR",!navigator.onLine)});window.addEventListener("online",n),window.addEventListener("offline",n),n()},showNotification:function(t,e){var n=t.commit,r=t.state,a=e.type,o=e.text,i=void 0===o?"":o,c=Fe;"error"===a&&(c="error");var s={text:i,color:c,id:r.count};n("ADD_NOTIFICATION",s),setTimeout((function(){n("DELETE_NOTIFICATION",s)}),He),n("INCREMENT_COUNT")},confirmUserAction:function(t){var e=t.commit,n=(t.state,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ue.defaultBottomSheet),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ye.DELETE;return new Promise((function(t){Me=t,e("SET_USER_ACTION",{type:r,text:n})}))},resolveConfirmUserAction:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,t.state,r("SET_USER_ACTION",null),Me(e);case 3:case"end":return n.stop()}}),n)})))()}}},Ye={DELETE:"delete"},Je={namespaced:!0,state:{isShowCreateRoom:!1,isShowDrawer:!1},mutations:{TOGGLE_SHOW_CREATE_ROOM:function(t,e){t.isShowCreateRoom=e},TOGGLE_SHOW_DRAWER:function(t,e){t.isShowDrawer=e}}},Ke="userName",ze={namespaced:!0,state:{userName:null},mutations:{LOGIN:function(t,e){t.userName=e},LOGOUT:function(t){t.userName=null}},actions:{login:function(t,e){var n=t.commit;return localStorage.setItem(Ke,e),n("LOGIN",e),e},logout:function(t){var e=t.commit;localStorage.removeItem(Ke),e("LOGOUT")},checkAuth:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dispatch,e.next=3,localStorage.getItem(Ke);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))()}}},Qe={namespaced:!0,state:{isConnect:!1},mutations:{SET_IS_CONNECT:function(t,e){t.isConnect=e}},actions:{connectSocket:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,t.dispatch,n.prev=1,a=Pe.ws.getSocket(e),a.onmessage=function(t){Xe.dispatch("rooms/processNewMessage",t)},n.next=6,a.connect();case 6:Ie=a,Xe.dispatch("notifications/showNotification",{text:Ue.initSocket}),r("SET_IS_CONNECT",!0),n.next=16;break;case 11:throw n.prev=11,n.t0=n["catch"](1),Xe.dispatch("notifications/showNotification",{text:Ue.errorGetInitSocket,type:"error"}),console.warn(n.t0),n.t0;case 16:case"end":return n.stop()}}),n,null,[[1,11]])})))()},sendSocket:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.commit,t.state,n.prev=1,e=JSON.stringify(e),Ie.send(e),n.next=11;break;case 6:throw n.prev=6,n.t0=n["catch"](1),Xe.dispatch("notifications/showNotification",{text:Ue.errorSendSocket,type:"error"}),console.dir(n.t0),n.t0;case 11:case"end":return n.stop()}}),n,null,[[1,6]])})))()},disconnectSocket:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.commit,e.prev=1,!Ie){e.next=5;break}return e.next=5,Ie.disconnect();case 5:n("SET_IS_CONNECT",!1),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.warn(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()}}};o["a"].use(l["a"]);var Xe=new l["a"].Store({modules:{rooms:Be,settings:We,notifications:qe,modals:Je,auth:ze,socket:Qe}}),Ze=n("f309"),tn=n("0879"),en=n("fcf4");o["a"].use(Ze["a"]);var nn=new Ze["a"]({theme:{themes:{light:{primary:Object({NODE_ENV:"production",VUE_APP_BASE_URL:"sega_mega_chat",VUE_APP_BASE_URL_SUB:"/sega_mega_chat",VUE_APP_API_BASE_URL:"https://nane.tada.team",VUE_APP_API_BASE_URL2:"http://localhost:8021",VUE_APP_SOCKET_BASE_URL:"wss://nane.tada.team",VUE_APP_SOCKET_BASE_URL2:"ws://localhost:8021",VUE_APP_PRIMARY_COLOR2:"#009688",VUE_APP_SECONDARY_COLOR2:"green",BASE_URL:"/"}).VUE_APP_PRIMARY_COLOR||en["a"].teal,secondary:Object({NODE_ENV:"production",VUE_APP_BASE_URL:"sega_mega_chat",VUE_APP_BASE_URL_SUB:"/sega_mega_chat",VUE_APP_API_BASE_URL:"https://nane.tada.team",VUE_APP_API_BASE_URL2:"http://localhost:8021",VUE_APP_SOCKET_BASE_URL:"wss://nane.tada.team",VUE_APP_SOCKET_BASE_URL2:"ws://localhost:8021",VUE_APP_PRIMARY_COLOR2:"#009688",VUE_APP_SECONDARY_COLOR2:"green",BASE_URL:"/"}).VUE_APP_SECONDARY_COLOR||en["a"].teal.lighten2,accent:en["a"].indigo.base}}},lang:{locales:{ru:tn["a"]},current:"ru"}});o["a"].config.productionTip=!1,new o["a"]({router:ve,store:Xe,vuetify:nn,render:function(t){return t(H)}}).$mount("#app")},"921f":function(t,e,n){},ac0c:function(t,e,n){"use strict";var r=n("124f"),a=n.n(r);a.a},f90b:function(t,e,n){"use strict";var r=n("921f"),a=n.n(r);a.a}});
//# sourceMappingURL=app.e8fde5e0.js.map